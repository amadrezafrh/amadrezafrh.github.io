<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Traffic Flow Measurement - Amadreza Farahani</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Deep Learning-Based Vehicle Detection and Traffic Flow Analysis" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]});"></script>
  <link rel="stylesheet" href="../css/styles.css" />
  <style>
    .figure-small img {
      max-width: 600px;
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-content">
        <div class="sidebar-photo">
          <img src="../me.JPG" alt="Amadreza Farahani" />
        </div>
        <h1>Amadreza Farahani</h1>
        <p class="tagline">AI/ML Engineer</p>
        <p class="intro">Building intelligent systems with LLMs, Computer Vision, and scalable ML infrastructure.</p>
        <div class="sidebar-links">
          <a href="mailto:amadreza.farahani@outlook.com">Email</a>
          <a href="https://linkedin.com/in/amadrezafrh" target="_blank">LinkedIn</a>
          <a href="https://github.com/amadrezafrh" target="_blank">GitHub</a>
          <a href="../resume/Amadreza.pdf" target="_blank" id="resume-link">Resume</a>
        </div>
        <nav class="sidebar-nav">
          <a href="../index.html">Home</a>
          <a href="../index.html#experience">Experience</a>
          <a href="../index.html#education">Education</a>
          <a href="../projects.html">Projects</a>
          <a href="../blog.html" id="nav-blog">Blog</a>
          <a href="../index.html#contact">Contact</a>
        </nav>
      </div>
    </aside>

    <main class="main-content">
      <article class="project-detail">
        <header class="project-header">
          <h1>Deep Learning-Based Vehicle Detection and Traffic Flow Analysis</h1>
          <div class="project-meta">
            <p class="project-date">June 2021</p>
            <p class="project-tags">
              <span>Python</span>
              <span>TensorFlow</span>
              <span>YOLOv4</span>
              <span>DeepSORT</span>
              <span>Computer Vision</span>
              <span>scikit-learn</span>
            </p>
          </div>
        </header>

        <section class="project-content">
          <nav class="toc">
            <p class="toc-title">Contents</p>
            <ul class="toc-list">
              <li><a href="#overview">1. Overview</a></li>
              <li><a href="#pipeline">2. Pipeline</a>
                <ul class="toc-list toc-sub">
                  <li><a href="#detection-tracking">2.1. Detection and Tracking</a></li>
                  <li><a href="#lane-clustering">2.2. Lane Clustering</a></li>
                  <li><a href="#svm-classification">2.3. SVM Classification</a></li>
                  <li><a href="#realtime-analysis">2.4. Real-time Analysis</a></li>
                </ul>
              </li>
              <li><a href="#conclusion">3. Conclusion</a></li>
              <li><a href="#links">4. Links</a></li>
            </ul>
          </nav>

          <h2 id="overview">1. Overview</h2>
          <p>
            This project was developed as part of a national initiative to measure traffic flow through 
            monitoring cameras installed at junctions in Tehran, Iran. The system uses YOLOv4 for vehicle 
            detection, DeepSORT for multi-object tracking, and a semi-supervised approach combining 
            Spectral Clustering with SVM for lane classification.
          </p>
          <p>
            <strong>Note:</strong> This project uses YOLOv4 and was trained on limited data with augmentation. 
            Many newer detection and tracking algorithms have since been developed with improved performance.
          </p>

          <h2 id="pipeline">2. Pipeline</h2>
          
          <h3 id="detection-tracking">2.1. Detection and Tracking</h3>
          <p>
            A custom YOLOv4 model was trained on aerial vehicle imagery. DeepSORT algorithm handles 
            multi-object tracking using a Kalman filter for state prediction and cosine distance 
            for appearance matching.
          </p>
          <p>
            The tracker maintains vehicle identities across frames using an 8-dimensional state space:
          </p>
          <p>
            $$\mathbf{x} = [x, y, a, h, \dot{x}, \dot{y}, \dot{a}, \dot{h}]^T$$
          </p>
          <p>
            where $(x, y)$ is the bounding box center, $a$ is the aspect ratio, $h$ is the height, 
            and the remaining components are their respective velocities.
          </p>
          <p>
            Association between detections and tracks uses a cost matrix combining appearance features 
            (cosine distance) and motion information (Mahalanobis distance), solved via the Hungarian algorithm.
          </p>
          <div class="project-figure">
            <img src="traffic-flow/tracking.gif" alt="Vehicle tracking demonstration" />
            <p class="figure-caption">Real-time vehicle detection and tracking using YOLOv4 and DeepSORT</p>
          </div>

          <h3 id="lane-clustering">2.2. Lane Clustering</h3>
          <p>
            From tracking, three features are extracted for each detected vehicle and normalized using StandardScaler:
          </p>
          <ul>
            <li>Horizontal position ($x$)</li>
            <li>Vertical position ($y$)</li>
            <li>Vehicle angle ($\theta$)</li>
          </ul>
          <p>
            Spectral Clustering is applied to group vehicles by lane. Processing 1000 frames yielded 
            approximately 60,000 vehicle detections with 180,000 total features. Various clustering 
            algorithms were evaluated using silhouette score, with Spectral Clustering producing the 
            best results.
          </p>
          <div class="project-figure figure-small">
            <img src="traffic-flow/spec_4.png" alt="Spectral clustering results" />
            <p class="figure-caption">Lane clustering using Spectral Clustering with 4 clusters</p>
          </div>

          <h3 id="svm-classification">2.3. SVM Classification</h3>
          <p>
            To refine the clustering results and handle edge cases, an SVM with RBF kernel was 
            trained on the labeled data from the clustering stage:
          </p>
          <p>
            $$K(x_i, x_j) = \exp\left(-\gamma \|x_i - x_j\|^2\right)$$
          </p>
          <p>
            The classifier takes normalized $(x, y)$ coordinates and predicts lane assignments, 
            reducing errors in lane boundaries.
          </p>
          <div class="project-figure figure-small">
            <img src="traffic-flow/spec_4_svm.png" alt="SVM classification results" />
            <p class="figure-caption">Refined lane classification after SVM training</p>
          </div>

          <h3 id="realtime-analysis">2.4. Real-time Analysis</h3>
          <p>
            The final pipeline integrates all components for real-time video processing. The system 
            classifies each detected vehicle into lanes and calculates per-lane statistics including 
            vehicle count and average speed for traffic management applications.
          </p>
          <div class="project-figure">
            <img src="traffic-flow/demo.gif" alt="Real-time traffic analysis" />
            <p class="figure-caption">Complete pipeline with lane classification and traffic analysis</p>
          </div>

          <h2 id="conclusion">3. Conclusion</h2>
          <p>
            This project demonstrates a complete pipeline for automated traffic flow measurement from 
            aerial imagery. The combination of deep learning-based detection (YOLOv4), robust tracking 
            (DeepSORT with Kalman filtering), and semi-supervised lane classification (Spectral Clustering 
            refined with SVM) provides an automated solution for traffic monitoring at scale.
          </p>

          <h2 id="links">4. Links</h2>
          <p class="project-links">
            <a href="https://github.com/amadrezafrh/Traffic-Flow-Measurement-Deep-Learning" target="_blank">GitHub Repository</a>
          </p>
        </section>

        <a href="../projects.html" class="back-link">Back to Projects</a>
      </article>
    </main>
  </div>

  <script src="../js/config.js"></script>
  <script>
    if (typeof siteConfig !== 'undefined') {
      if (siteConfig.hide_blog) {
        const blogNav = document.getElementById('nav-blog');
        if (blogNav) blogNav.style.display = 'none';
      }
      if (siteConfig.hide_resume) {
        const resumeLink = document.getElementById('resume-link');
        if (resumeLink) resumeLink.style.display = 'none';
      }
      if (siteConfig.project_max_width) {
        document.documentElement.style.setProperty('--content-max-width', siteConfig.project_max_width);
      }
    }
  </script>
</body>
</html>
